<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Assignment 2: Callback Function and Advanced HTML DOM</title>
    <link rel="stylesheet" href="stylesheets/style.css">
 <!--    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script> -->
</head>
<body>
    <header>
        <h1 class="header h1">Callback Function and Advanced HTML DOM</h1>
    </header>
    <section class="namecard">
        <div  class="namecard-form u-margin">
            <table id="table" style="width:100%">
              <tr>
                <td> </td>
                <td> Name </td>
                <td> Price </td>
                <td> Description </td>
              </tr>

            </table>
        </div>
    </section>
    <section  class="u-margin">
    <code>
        <pre>

    function ajax(src, callback){
        var xhr = new XMLHttpRequest();
                xhr.open('GET', src, true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.setRequestHeader('Access-Control-Allow-Origin', 'https://cwpeng.github.io/live-records-samples/data/products.json');
                xhr.setRequestHeader('Access-Control-Allow-Credential',true);
                xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET');
                xhr.send();

                xhr.onload = function() {
                if (xhr.status === 200) {
                    callback(JSON.parse(xhr.responseText));
                } else {
                   alert('Request failed.  Returned status of ' + xhr.status);
                }
                };        
    }
    function render(data){
        for (let i = 0; i< data.length; i++){
        
            console.log(data[i].name );
            let shopHTML = " ";
            shopHTML += "&lt;tr>&lt;td>"+ i +"&lt;/td>&lt;td>"+ data[i].name+"&lt;/td>&lt;td>"+ data[i].price +"&lt;/td>&lt;td>"+data[i].description+"&lt;/td>&lt;/tr>";
            console.log(shopHTML);
            $(table).append(shopHTML);
        }
     }
    ajax("https://cwpeng.github.io/live-records-samples/data/products.json", function(response){
            render(response);
        });
        </pre>
    </code>           
    </section> 
    <script>
        function ajax(src, callback){
        var xhr = new XMLHttpRequest();
                xhr.open('GET', src, true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.setRequestHeader('Access-Control-Allow-Origin', 'https://cwpeng.github.io/live-records-samples/data/products.json');
                xhr.setRequestHeader('Access-Control-Allow-Credential',true);
                xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET');
                xhr.send();

                xhr.onload = function() {
                if (xhr.status === 200) {
                    callback(JSON.parse(xhr.responseText));
                } else {
                   alert('Request failed.  Returned status of ' + xhr.status);
                }
                };
        }
        function render(data){
            for (let i = 0; i< data.length; i++){
            
                console.log(data[i].name );
                let shopHTML = " ";
                shopHTML += "<tr><td>"+ i +"</td><td>"+ data[i].name+"</td><td>"+ data[i].price +"</td><td>"+data[i].description+"</td></tr>";
                console.log(shopHTML);
                $(table).append(shopHTML);
            }
         }
        ajax("https://cwpeng.github.io/live-records-samples/data/products.json", function(response){
                render(response);
            });
    </script>
</body>

</html>